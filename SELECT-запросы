*Название и продолжительность самого длительного трека*
SELECT nametrack, lengthtrack
FROM track
WHERE lengthtrack = (SELECT MAX(lengthtrack) FROM track);

SELECT nametrack, lengthtrack
FROM track
ORDER by lengthtrack DESC
LIMIT 1;

*Название треков, продолжительность которых не менее 3,5 минут*
SELECT nametrack
FROM track
WHERE lengthtrack > 210;

*Названия сборников, вышедших в период с 2018 по 2020 год включительно*
SELECT nametrack, releasealbum FROM album a
LEFT JOIN track t ON a.albumid = t.albumid
WHERE releasealbum BETWEEN 2018 AND 2020;

*Исполнители, чьё имя состоит из одного слова*
SELECT namemusician FROM musician m 
WHERE namemusician NOT LIKE '% %';

*Название треков, которые содержат слово «мой» или «my»*
SELECT nametrack
FROM track
where LOWER(nametrack) like '%my%';


*Количество исполнителей в каждом жанре*
SELECT namegenre, COUNT(m1.namemusician) FROM musicalgenre m3
LEFT JOIN musiciansgenres m2 ON m3.genreid = m2.genreid 
LEFT JOIN musician m1 ON m2.musicianid = m1.musicianid
GROUP BY namegenre 
ORDER BY count(m1.namemusician) DESC;

*Количество треков, вошедших в альбомы 2019–2020 годов*
SELECT count(nametrack) FROM track
JOIN album ON track.albumid = album.albumid
WHERE releasealbum BETWEEN 2019 AND 2020;

*Средняя продолжительность треков по каждому альбому*
SELECT album.namealbum, AVG(lengthtrack) FROM track 
JOIN album ON track.albumid = album.albumid
GROUP BY namealbum 
ORDER BY AVG(lengthtrack);

*Все исполнители, которые не выпустили альбомы в 2020 году*
SELECT namemusician, a.releasealbum FROM musician m1
LEFT JOIN musiciansalbums m2 ON m1.musicianid = m2.musicianid 
LEFT JOIN album a ON a.albumid = m2.albumid
WHERE namemusician IN (SELECT namemusician FROM musiciansalbums WHERE a.releasealbum NOT BETWEEN 2020 AND 2020) 
OR namemusician IN (SELECT namemusician FROM musiciansalbums WHERE a.releasealbum ISNULL);

*Названия сборников, в которых присутствует конкретный исполнитель (выберите его сами)*
SELECT namecollection FROM collection c 
LEFT JOIN trackscollections tc ON c.collectionid = tc.collectionid 
LEFT JOIN track t ON t.trackid = tc.trackid 
LEFT JOIN album a ON t.albumid = a.albumid 
LEFT JOIN musiciansalbums ma ON ma.albumid = a.albumid 
LEFT JOIN musician m ON m.musicianid = ma.musicianid
WHERE LOWER(m.namemusician) LIKE 'thunder monk';
